language: python
python:
  - "3.8"
  - "3.9"
  - "3.10"

dist: focal

services:
  - xvfb

addons:
  apt:
    packages:
      - libgl1-mesa-glx
      - libgtk2.0-0
      - libsm6
      - libxext6
      - libxrender-dev

env:
  global:
    - CI=true

before_install:
  - cd flaskapp  # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –ø–∞–ø–∫—É —Å –ø—Ä–æ–µ–∫—Ç–æ–º
  - python --version
  - pip --version

install:
  - pip install --upgrade pip
  - pip install -r requirements.txt
  - pip install pytest pytest-cov

script:
  - python -c "import flask; print('‚úÖ Flask version:', flask.__version__)"
  - python -c "import cv2; print('‚úÖ OpenCV version:', cv2.__version__)"
  - python -c "import numpy; print('‚úÖ NumPy version:', numpy.__version__)"
  - python -m pytest tests/ -v --cov=. --tb=short

after_success:
  - echo "üéâ All tests passed successfully!"
  - echo "Python version: $(python --version)"

notifications:
  email: false

cache:
  pip: true
  directories:
    - $HOME/.cache/pip
